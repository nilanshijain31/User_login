"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[917],{37765:function(e,t,r){r.d(t,{b:function(){return o}});var n=r(52322),l=r(7339),a=r(94951),i=r(17581);r(39515),r(62159),r(23171);var s=(0,r(46724).c)({defaultClassName:"_fsmm4n4 _1286nb12if _1286nb128f _1286nb1239 _1286nb12d9 _1286nb16os _1286nb18l _1286nb12t3 _1286nb12tb",variantClassNames:{type:{danger:"_1286nb1821",info:"_1286nb176j",success:"_1286nb17xj"}},defaultVariants:{},compoundVariants:[]});let o=e=>{let{onClose:t,button:r,children:o,icon:c,permanent:u,type:d}=e;return(0,n.jsxs)(l.x,{className:s({type:d}),children:[c&&(0,n.jsx)(l.x,{display:{default:"none",sm:"inline-block"},children:(0,n.jsx)(a.J,{as:c,marginRight:"10",display:"block"})}),(0,n.jsxs)(l.x,{flex:"1",display:{default:"block",sm:"flex"},alignItems:"center",justifyContent:"space-between",children:[(0,n.jsx)(l.x,{as:"p",marginRight:{default:"0",sm:"15"},marginBottom:{default:"5",sm:"0"},children:o}),r]}),!u&&(0,n.jsx)(l.x,{as:"button",padding:"5",marginRight:"-5",color:"white",onClick:t||void 0,children:(0,n.jsx)(a.J,{as:i.Z,marginLeft:"10"})})]})}},54928:function(e,t,r){r.d(t,{t:function(){return s}});var n=r(2784),l=r(53476),a=r(16783),i=r(39145);let s=()=>{let e=(0,l.Zl)(i.IT);return(0,n.useCallback)(t=>{a.s.set(t),e(t)},[e])}},20891:function(e,t,r){r.d(t,{Q:function(){return c}});var n=r(37908),l=r(2784);let a=e=>{e&&localStorage.getItem("abtasty/usertype")!==e&&localStorage.setItem("abtasty/usertype",e)};var i=r(38985);let s=async(e,t)=>{try{let r=await fetch("/api/user/wallet/".concat(e,"/").concat(t));if(!r.ok)throw Error("Error fetching user wallet");return await r.json()}catch(e){throw e&&e instanceof Error&&console.error(JSON.stringify({fatal_error:e.message})),Error("Error fetching user wallet")}};var o=r(54928);let c=e=>{let t=(0,o.t)(),r=(0,n.K)();return(0,l.useCallback)(async()=>{try{let e=i.f.get();if(!r||!(null==e?void 0:e.wallet_id))return;let n=await s(e.id,e.wallet_id);t(n),a(n.plan)}catch(t){e&&e()}},[r,e,t])}},16783:function(e,t,r){r.d(t,{s:function(){return a}});var n=r(45579);let l="user/wallet",a={get:()=>{try{let e=localStorage.getItem(l);if(!e)return null;return n.U1.parse(JSON.parse(e))}catch(e){return null}},set:e=>{localStorage.setItem(l,JSON.stringify(e))},remove:()=>{localStorage.removeItem(l)}}},66485:function(e,t,r){r.d(t,{Z:function(){return a}});var n=r(38912);let l="session/xhr/device-manager/identify",a=(()=>{let e=()=>{try{let e=localStorage.getItem(l);if(!e)return null;return n.h.parse(JSON.parse(e))}catch(e){return null}};return{get:e,set:e=>localStorage.setItem(l,JSON.stringify(e)),remove:()=>localStorage.removeItem(l),isDeviceBlocked:()=>{var t;return null===(t=e())||void 0===t?void 0:t.disabled}}})()},80050:function(e,t,r){r.d(t,{en:function(){return h},Il:function(){return j},qx:function(){return g}});var n=r(52322),l=r(29676),a=r(37765),i=r(3785),s=r(7415),o=r(86850),c=r(53476),u=r(66485);let d=(0,c.cn)({key:"deviceIdentifyState",default:void 0,effects:[e=>{let{onSet:t}=e;t(e=>{if(!e){u.Z.remove();return}u.Z.set(e)})}]}),f=(0,c.cn)({key:"deviceBlockedModalState",default:!1}),m=(0,c.nZ)({key:"isDeviceBlocked",get:e=>{let{get:t}=e,r=t(d);return!!r&&r.disabled}}),g=()=>{let[e,t]=(0,c.FV)(f),r=(0,c.sJ)(m);return{isDeviceBlocked:(0,o.Aw)("DEVICE_LIMIT_BLOCK")&&r,isOpenDeviceBlockedModal:e,showDeviceBlockedModal:()=>t(!0),hideDeviceBlockedModal:()=>t(!1)}};var b=r(7339),p=r(94951),_=r(86903);r(39515),r(62159);let v=()=>{let{t:e}=(0,s.$G)("detail"),{isOpenDeviceBlockedModal:t,hideDeviceBlockedModal:r}=g();return(0,n.jsx)(_.u,{size:"sm",open:t,onOpenChange:r,children:(0,n.jsxs)(b.x,{textAlign:"center",children:[(0,n.jsxs)("div",{className:"_1286nb12nf _1286nb12r3 _1286nb18l _1286nb12t9 _1286nb12tx _1286nb16ea",children:[(0,n.jsx)(p.J,{as:i.Z,size:"2xl",className:"_1286nb11h9 _1286nb168s"}),e("deviceBlocked.title")]}),(0,n.jsx)("p",{className:"_1286nb11af _1286nb11p3 _1286nb12nr _1286nb16ea _1286nb12s3",children:e("deviceBlocked.description")}),(0,n.jsx)(l.gg,{as:"a",href:"/user/device-manager",children:e("deviceBlocked.button")})]})})},h=()=>{let{t:e}=(0,s.$G)("common"),t="danger",{isDeviceBlocked:r}=g();if(!r)return null;let o=(0,n.jsx)(l.gg,{size:"sm",color:t,href:"/user/device-manager",children:e("downloadsDisabled.button")});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a.b,{type:t,button:o,icon:i.Z,permanent:!0,children:[(0,n.jsx)("strong",{children:e("downloadsDisabled.title")})," ",e("downloadsDisabled.description")]}),(0,n.jsx)(v,{})]})};var w=r(21805),y=r(2784),z=r(38912);let x=async()=>{let e=await fetch("/user/device-manager/identify",{headers:{"Content-Type":"application/json","X-CSRF-TOKEN":w.Z.get("csrf_freepik")||"","X-Requested-With":"XMLHttpRequest"},method:"POST"});if(!e.ok)throw Error("Error checking user device data.");let t=await e.json();return z.I.parse(t)},j=e=>{let{children:t}=e,r=(0,c.Zl)(d);return(0,y.useEffect)(()=>{let e=async()=>{let e=new Date().getTime(),t={disabled:!1,expiry:e+18e5},r=u.Z.get();if(r&&r.expiry>e)return r;try{let e=await x();t.disabled=e.success&&e.disabled}catch(e){console.error("Error getting device manager status",e)}finally{u.Z.set(t)}return t};w.Z.get("GRID")&&e().then(r)},[r]),(0,n.jsx)(n.Fragment,{children:t})}},38912:function(e,t,r){r.d(t,{I:function(){return l},h:function(){return a}});var n=r(30195);let l=n.z.object({csrfToken:n.z.string().optional(),success:n.z.boolean(),disabled:n.z.boolean()}),a=n.z.object({disabled:n.z.boolean(),expiry:n.z.number()})},28092:function(e,t,r){r.d(t,{J$:function(){return u},WH:function(){return d},fs:function(){return o},nW:function(){return a}});var n=r(30195);let l={a:"avatar",cce:"cc_will_expire",d:"downloads",dr:"download_limit_renew",e:"email",fbfi:"first_buy_fr",id:"id",l:"login",ld:"limit_downloads",nl:"newsletter",pm:"premium",pmt:"premiumtest",rcfi:"renewal_canceled_flaticon",rcfp:"renewal_canceled_freepik",rcpp:"renewal_canceled_plus",rn:"real_name",ug:"user_age",utfi:"user_type_fi",utfr:"user_type_fr",pch:"purchases",w:"wallet_id"},a=Object.entries(l).reduce((e,t)=>{let[r,n]=t;return{...e,[n]:r}},{}),i=n.z.object({id:n.z.string(),status:n.z.string(),product:n.z.string()}),s=n.z.object({avatar:n.z.string(),email:n.z.string(),id:n.z.number(),login:n.z.string(),real_name:n.z.string().nullable(),premium:n.z.boolean().default(!1),premiumtest:n.z.boolean().default(!1),cc_will_expire:n.z.boolean().default(!1),downloads:n.z.number(),renewal_canceled_freepik:n.z.boolean().default(!1),renewal_canceled_flaticon:n.z.boolean().default(!1),renewal_canceled_plus:n.z.boolean().default(!1),limit_downloads:n.z.number(),user_age:n.z.string().optional(),user_type_fr:n.z.string().optional(),newsletter:n.z.boolean().default(!1),download_limit_renew:n.z.number().optional().nullable(),purchases:n.z.array(i).optional(),wallet_id:n.z.string().optional().nullable()}),o=n.z.object({success:n.z.literal(!0),data:s,csrfToken:n.z.string()}).transform(e=>{let{data:t}=e;return t});n.z.object({data:n.z.array(i),csrfToken:n.z.string().optional()}).transform(e=>{let{data:t}=e;return t});let c=Object.keys(s.shape).reduce((e,t)=>({...e,[a[t]]:s.shape[t]}),{}),u=n.z.object(c).transform(e=>Object.entries(e).reduce((e,t)=>{let[r,n]=t;return{...e,[l[r]]:n}},{})),d=n.z.object({expiry:n.z.number().refine(e=>e>Date.now()),value:n.z.string()})},38985:function(e,t,r){r.d(t,{f:function(){return s}});var n=r(28092);let l="session/user",a="downloads/consumed",i="downloads/limit",s=(()=>{let e;let t=()=>{let t=Date.now();return e&&e.expiry>t?e.value:null},r=()=>{try{let t=localStorage.getItem(l);if(!t)return null;let r=n.WH.parse(JSON.parse(t)),a=n.J$.parse(JSON.parse(r.value));return e={value:a,expiry:r.expiry},a}catch(e){return null}},s=()=>t()||r(),o=t=>{if("id"in t){let r=Date.now()+36e5;e={value:t,expiry:r};let a=Object.keys(t).reduce((e,r)=>(e[n.nW[r]]=t[r],e),{});localStorage.setItem(l,JSON.stringify({value:JSON.stringify(a),expiry:r}))}localStorage.setItem(a,"".concat(t.downloads)),localStorage.setItem(i,"".concat(t.limit_downloads))};return{get:s,getValue:e=>{let t=s();return t?t[e]:null},set:o,update:e=>{let t=s();t&&o({...t,...e})},remove:()=>{localStorage.removeItem(l),localStorage.removeItem(a),localStorage.removeItem(i),sessionStorage.removeItem("user/purchases")}}})()}}]);